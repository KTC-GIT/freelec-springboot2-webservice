# 워크플로우의 이름
name: simple-springboot3-webservice

# 'main' 또는 'master' 브랜치에 'push' 또는 'pull_request'가 발생하면 실행
on:
  push:
    branches: [ "main", "master" ]
  pull_request:
    branches: [ "main", "master" ]

# 실행할 작업
jobs:
  build:
    # GitHub가 제공하는 기본 Ubuntu 최신 환경에서 실행
    runs-on: ubuntu-latest

    steps:
      # (1) 소스 코드 가져오기
      - name: Checkout
        uses: actions/checkout@v4

      # (2) JDK 11 설치 (프로젝트에 맞게 8, 17 등으로 변경)
      - name: Set up JDK 21
        uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'

      # [추가된 부분] gradlew 스크립트의 줄바꿈 문자(CRLF)를 LF로 변경
      - name: Fix gradlew line endings
        run: sed -i 's/\r$//' ./gradlew

      # (3) gradlew 파일에 실행 권한 부여
      - name: Grant execute permission for gradlew
        run: chmod +x ./gradlew

      # (4) Gradle로 빌드 실행
      - name: Build with Gradle
        run: ./gradleW clean build